---
title: "Redis FAQ"
linkTitle: "FAQ"
weight: 100
description: >
    Commonly asked questions when getting started with Redis
aliases:
    - /docs/getting-started/faq
---

## Redis 与其他键值存储有何不同？

*   Redis 在键值数据库中具有不同的演进路径，其中值可以包含更复杂的数据类型，并在这些数据类型上定义原子操作。Redis 数据类型与基本数据结构密切相关，并且以这种方式向程序员公开，而无需额外的抽象层。
*   Redis 是一个内存中但持久的磁盘数据库，因此它代表了一种不同的权衡，其中非常高的写入和读取速度，并且限制了不能大于内存的数据集。另一个优点内存数据库是复杂数据结构的内存表示与磁盘上的相同数据结构相比，操作起来要简单得多，因此 Redis 可以做很多事情，而内部复杂性很小。同时两种磁盘存储格式（RDB 和 AOF）不需要适合随机 access，因此它们很紧凑，并且始终以仅追加的方式生成（甚至 AOF 日志轮换也是仅追加操作，因为新版本从内存中的数据副本生成）。但是，此设计还涉及与传统的磁盘存储相比，存在不同的挑战。作为主要数据内存上的表示，Redis操作必须仔细处理以确保磁盘上始终存在数据集的更新版本。

## Redis 内存占用量是多少？

举几个例子（全部使用 64 位实例获得）：

*   空实例使用约 3MB 的内存。
*   100 万个小键 - >字符串值对使用约 85MB 的内存。
*   100 万个键 - >哈希值，表示具有 5 个字段的对象，使用约 160 MB 的内存。

测试您的用例是微不足道的。使用`redis-benchmark`实用程序生成随机数据集，然后检查与`INFO memory`命令。

与 32 位系统相比，64 位系统将使用比 32 位系统多得多的内存来存储相同的密钥，尤其是在密钥和值很小的情况下。这是因为指针在 64 位系统中占用 8 个字节。但当然，优点是你可以在64位系统中具有大量内存，因此为了运行大型Redis服务器，或多或少需要64位系统。另一种方法是分片。

## 为什么 Redis 将其整个数据集保存在内存中？

过去，Redis开发人员尝试使用虚拟内存和其他系统，以允许大于RAM的数据集，但毕竟，如果我们能做好一件事，我们非常高兴：从内存提供数据，用于存储的磁盘。因此，目前还没有计划为Redis创建磁盘后端。大部分什么毕竟，Redis是其当前设计的直接结果。

如果您真正的问题不是所需的总RAM，而是您需要的事实要将您的数据集拆分为多个 Redis 实例，请阅读[分区页](/topics/partitioning)有关详细信息，请参阅本文档。

Redis Ltd.，赞助 Redis 开发的公司，已经开发了一个 "Redis on Flash" 解决方案，使用混合 RAM/闪存方法具有有偏见的访问模式的较大数据集。您可以查看他们的产品有关更多信息，但此功能不是开源 Redis 的一部分代码库。

## 是否可以将 Redis 与基于磁盘的数据库一起使用？

是的，常见的设计模式涉及获取写入量非常大的小数据在 Redis 中（以及您需要 Redis 数据结构来对问题进行建模的数据）以有效的方式），并且大*斑点*将数据转换为 SQL 或最终一致的磁盘数据库。同样，有时使用 Redis 是为了在内存中获取存储在磁盘上的相同数据的子集的另一个副本数据库。这可能看起来类似于缓存，但实际上是一个更高级的模型。
由于 Redis 数据集通常与磁盘数据库数据集一起更新，并且不会在缓存未命中时刷新。

## 如何减少 Redis 的整体内存使用量？

如果可以，请使用 Redis 32 位实例。还要充分利用小哈希，列表、排序集和整数集，因为 Redis 能够表示那些数据类型在特殊情况下的几个元素在一个更紧凑道路。在[内存优化页面](/topics/memory-optimization).

## 如果 Redis 内存不足，会发生什么情况？

Redis具有内置保护功能，允许用户设置内存的最大限制用法， 使用`maxmemory`配置文件中的选项以设置限制到 Redis 可以使用的内存。如果达到此限制，Redis 将开始回复写入命令时出现错误（但将继续接受只读命令）。

您还可以将 Redis 配置为在最大内存限制时逐出 key 已到达。查看[淘汰策略](/docs/manual/eviction/)以获取有关此内容的更多信息。

## 后台保存失败，在 Linux 上出现 fork（） 错误？

简短的回答：`echo 1 > /proc/sys/vm/overcommit_memory`:)

现在是长一个：

Redis 后台保存架构依赖于`fork`系统呼入现代操作系统：Redis 分叉（创建子进程），即父项的精确副本。子进程将数据库转储到磁盘上，最后出口。从理论上讲，孩子应该使用与父母一样多的记忆复制，但实际上要归功于大多数实现的写入时复制语义现代操作系统的父进程和子进程将*共享*共同点内存页。仅当页面在子项或父级。因为从理论上讲，所有页面都可能更改，而子进程是节省，Linux无法提前告诉孩子将占用多少内存，因此如果这`overcommit_memory`设置设置为零，分叉将失败，除非有根据需要提供尽可能多的可用 RAM，以真正复制所有父内存页。如果你有一个 3 GB 的 Redis 数据集，只有 2 GB 的可用空间
内存它将失败。

设置`overcommit_memory`to 1 告诉 Linux 放松并执行分叉更乐观的分配方式，这确实是你对Redis想要的。

您可以参考[过程（5）][proc5]手册页，用于解释可用值。

[proc5]: http://man7.org/linux/man-pages/man5/proc.5.html

## 磁盘上的 Redis 快照是原子快照吗？

是的，当服务器处于在执行命令之外，因此每个命令都报告为原子命令从磁盘快照的角度来看，RAM也是原子的。

## Redis 如何使用多个 CPU 或内核？

CPU 成为 Redis 的瓶颈并不常见，因为通常 Redis 是内存或网络绑定的。例如，当使用流水线时，在平均Linux系统上运行的Redis实例每秒可以传递100万个请求，因此，如果您的应用程序主要使用O（N）或O（log（N））命令，则几乎不会使用太多的CPU。

但是，为了最大限度地提高 CPU 使用率，您可以在同一个盒子，并将它们视为不同的服务器。在某些时候，单个无论如何，box可能还不够，所以如果你想使用多个CPU，你可以开始考虑一些更早的分片方法。

您可以在[分区页面](/topics/partitioning).

从 4.0 版开始，Redis 已开始实施线程操作。目前，这仅限于删除后台的对象和阻止通过 Redis 模块实现的命令。对于后续版本，计划是使 Redis 越来越线程化。

## 单个 Redis 实例可以容纳的最大密钥数是多少？哈希集、列表集、集和排序集中的最大元素数是多少？

Redis 最多可以处理 2^32 个密钥，并在实践中进行了测试每个实例至少处理 2.5 亿个密钥。

每个哈希、列表、集合和排序集都可以包含 2^32 个元素。

换句话说，您的限制可能是系统中的可用内存。

## 为什么我的复制副本的主实例具有不同数量的密钥？

如果使用生存时间有限的密钥（Redis 过期），这是正常行为。这是发生的事情：

*   主数据库在与副本的第一次同步时生成一个 RDB 文件。
*   RDB 文件将不包括主文件中已过期但仍在内存中的密钥。
*   这些密钥仍在 Redis 主数据库的内存中，即使逻辑上已过期也是如此。它们将被视为不存在，并且稍后将以增量方式或在访问时显式回收其内存。虽然这些键在逻辑上不是数据集的一部分，但它们在`INFO`输出和`DBSIZE`命令。
*   当副本读取主数据库生成的 RDB 文件时，将不会加载这组密钥。

因此，对于具有许多过期密钥的用户来说，在副本中看到较少的密钥是很常见的。但是，从逻辑上讲，主副本和副本将具有相同的内容。

## “Redis”这个名字从何而来？

Redis 是一个首字母缩略词，代表**再**莫特**地**词典**S**呃。

## 为什么Salvatore Sanfilippo开始了Redis项目？

萨尔瓦多最初创建了Redis以进行扩展[卢格](https://github.com/antirez/lloogg)，这是一个实时日志分析工具。但是在让基本的Redis服务器工作之后，他决定与其他人分享工作，并将Redis变成一个开源项目。

## Redis是如何发音的？

"Redis"（/ˈrɛd-ɪs/）的发音类似于 "红色" 一词加上 "kiss" 一词，但没有 "k"。
