将指定的地理空间项目 (经度、纬度、名称) 添加到指定的键。数据作为排序集存储在键中, 其方式使得查询项目的方式`GEOSEARCH`命令。

该命令采用标准格式 x, y 的参数, 因此必须在纬度之前指定经度。可以索引的坐标有限制：非常靠近两极的区域不可索引。

EPSG：900913 / EPSG：3785 / OSGEO：41001 指定的确切限制如下：

*   有效经度为 -180 到 180 度。
*   有效纬度为 -85.05112878 至 85.05112878 度。

当用户尝试为指定范围之外的坐标编制索引时, 该命令将报告错误。

**注意：**没有**吉奥德尔**命令, 因为您可以使用`ZREM`以删除元素。Geo 索引结构只是一个排序集。

## 地理添加选项

`GEOADD`还提供了以下选项：

*   **二十**：仅更新已存在的元素。切勿添加元素。
*   **断续器**：不要更新已存在的元素。始终添加新元素。
*   **中文**：将返回值从添加的新元素数修改为已更改的元素总数 (CH 是*改变*).更改的元素是**添加了新元素**和已存在的元素**坐标已更新**.因, , 在命令行中指定的元素与过去具有相同分数的元素不计算在内。注：通, , 返回值`GEOADD`仅计算添加的新元素的数量。

注意：**二十**和**断续器**选项是互斥的。

## 它是如何工作的？

填充排序集的方式是使用一种称为
[地理哈希](https://en.wikipedia.org/wiki/Geohash).经纬度
位交错形成唯一的 52 位整数。我们知道
排序集双精度分数可以表示 52 位整数而不会丢失
精度。

此格式允许通过选中覆盖整个形状所需的 1+8 个区域并丢弃其外部的元素来查询边界框和半径。通过计算所覆盖框的范围, 从排序集分数的不太重要的部分中删除足够的位, 并计算分数范围以在每个区域的排序集中查询, 来检查区域。

## 它使用什么地球模型？

该模型假设地球是一个球体, 因为它使用哈弗正弦公式来计算距离。这个公式只是一个近似值, 当应用于地球时, 地球不是一个完美的球体。
例如, 在社交网络和需要此类查询的类似应用程序使用时, 引入的错误不是问题。
但是, 在最坏的情况下, 错误可能高达 0.5%, 因此您可能需要考虑其他系统来处理错误关键型应用程序。

@return

@integer回复, 具体而言：

*   在没有可选参数的情况下使用时, 添加到排序集的元素数 (不包括分数更) ) 。
*   如果`CH`选项, 即已更改 (添加或更) ) 的元素数。

@examples

```cli
GEOADD Sicily 13.361389 38.115556 "Palermo" 15.087269 37.502669 "Catania"
GEODIST Sicily Palermo Catania
GEORADIUS Sicily 15 37 100 km
GEORADIUS Sicily 15 37 200 km
```
