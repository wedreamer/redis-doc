计算字符串中设置的位数（总体计数）。

默认情况下，将检查字符串中包含的所有字节。
只能在传递
其他参数*开始*和*结束*.

喜欢`GETRANGE`命令开始和结束可以包含负值
从字符串末尾开始索引字节的顺序，其中 -1 是最后一个
byte， -2 是倒数第二个，依此类推。

不存在的键被视为空字符串，因此该命令将返回零。

默认情况下，附加参数*开始*和*结束*指定字节索引。
我们可以使用一个附加参数`BIT`以指定位索引。
所以0是第一位，1是第二位，依此类推。
对于负值，-1 是最后一位，-2 是倒数第二位，依此类推。

@return

@integer回复

设置为 1 的位数。

@examples

```cli
SET mykey "foobar"
BITCOUNT mykey
BITCOUNT mykey 0 0
BITCOUNT mykey 1 1
BITCOUNT mykey 1 1 BYTE
BITCOUNT mykey 5 30 BIT
```

## 模式：使用位图的实时指标

位图是某些类型的非常节省空间的表示形式
信息。
一个例子是需要用户访问历史记录的 Web 应用程序，以便
例如，可以确定哪些用户是beta的良好目标
特征。

使用`SETBIT`命令这是微不足道的完成，每天识别
带有一个小的渐进整数。
例如，第 0 天是应用程序上线的第一天，第 1 天是
第二天，以此类推。

每次用户执行页面视图时，应用程序都可以在
用户使用`SETBIT`命令设置
对应于当前日期的位。

稍后，知道用户访问的单天数将是微不足道的
网站简单地调用`BITCOUNT`命令。

描述了使用用户 ID 而不是天数的类似模式
在文章中称为”[使用 Redis 快速、轻松的实时指标
位图][hbgc212fermurb]".

[hbgc212fermurb]: http://blog.getspool.com/2011/11/29/fast-easy-realtime-metrics-using-redis-bitmaps

## 性能注意事项

在上面的计算天数的例子中，即使在10年后，应用
在线我们仍然只有`365*10`每个用户的数据位，即仅 456 字节
每个用户。
有了这么大的数据量`BITCOUNT`仍然像任何其他O（1）Redis一样快
命令类似`GET`或`INCR`.

当位图很大时，有两种选择：

*   获取一个分离的键，该键在每次修改位图时递增。
    使用小型 Redis Lua 脚本，这可以非常高效和原子。
*   使用`BITCOUNT` *开始*和*结束*
    可选参数，累积结果客户端，以及可选
    将结果缓存到键中。
