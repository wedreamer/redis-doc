`CLIENT PAUSE`是一个连接控制命令, 能够在指定的时间量 (以毫秒为单位) 内挂起所有 Redis 客户端。

该命令执行以下操作：

*   它停止处理给定模式下来自普通客户端和发布/订阅客户端的所有挂起命令。但是, 与副本的交互将正常继续。请注意, 当客户端尝试执行命令时, 它们会正式暂停, 因此不会在服务器端为非活动客户端执行任何工作。
*   但是, 它尽快返回给调用方OK, 因此`CLIENT PAUSE`命令执行不会自行暂停。
*   当经过指定的时间量后, 所有客户端都将被取消阻止：这将触发对暂停期间每个客户端的查询缓冲区中累积的所有命令的处理。

客户端暂停目前支持两种模式：

*   `ALL`：这是默认模式。所有客户端命令都将被阻止。
*   `WRITE`：仅当客户端尝试执行写入命令时, 才会阻止客户端。

对于`WRITE`模式中, 某些命令具有特殊行为：

*   `EVAL`/`EVALSHA`：将阻止所有脚本的客户端。
*   `PUBLISH`：将阻止客户端。
*   `PFCOUNT`：将阻止客户端。
*   `WAIT`：确认将被延迟, 因此此命令将显示为已阻止。

此命令很有用, 因为它能够以受控方式将客户端从 Redis 实例切换到另一个实例。例如, 在实例升级期间, 系统管理员可以执行以下操作：

*   暂停客户端使用`CLIENT PAUSE`
*   等待几秒钟, 以确保副本处理了来自主服务器的最新复制流。
*   将其中一个副本转换为主副本。
*   重新配置客户端以与新主服务器连接。

自 Redis 6.2 起, 客户端暂停的推荐模式为`WRITE`.此模式将停止所有复制流量, 可以是
中止与`CLIENT UNPAUSE`命令, 并允许重新配置旧的主服务器, 而不会冒着在
故障转移。这也是群集故障转移期间使用的模式。

对于 6.2 之前的版本, 可以发送`CLIENT PAUSE`在 MULTI/EXEC 块中与`INFO replication`命令, 以便在客户端被阻止时获取当前主偏移量。这样, 就可以等待副本端的特定偏移, 以确保处理了所有复制流。

由于 Redis 3.2.10 / 4.0.0, 此命令还可以防止密钥被逐出或
在客户端暂停期间过期。这样可以保证数据集
不仅要从客户无法写入的角度来看, 还要从内部操作的角度来看保持静态。

@return

@simple字符串回复：如果超时无效, 则该命令返回 OK 或错误。

## 行为更改历史记录

*   `>= 3.2.0`：客户端暂停可防止客户端暂停和密钥逐出。
