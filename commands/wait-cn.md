此命令将阻止当前客户端，直到所有以前的写入命令
至少由指定的号码成功传输和确认
的副本。如果达到以毫秒为单位指定的超时，则命令
即使尚未达到指定数量的副本，也会返回。

命令**会一直回来**已确认的副本数
在`WAIT`命令，在以下情况下
达到指定数量的副本，或者在达到超时时达到指定数量。

几点说明：

1.  什么时候`WAIT`返回，在当前连接的上下文中发送的所有先前写入命令都保证由返回的副本数接收`WAIT`.
2.  如果命令是作为`MULTI`事务，该命令不会阻塞，而只是尽快返回确认先前写入命令的副本数。
3.  超时值为 0 表示永久阻止。
4.  因为`WAIT`返回在失败和成功时达到的副本数，客户端应检查返回的值是否等于或大于它所要求的复制级别。

## 一致性和等待

请注意，`WAIT`并没有使 Redis 成为一个强一致的存储：虽然同步复制是复制状态机的一部分，但它并不是唯一需要的东西。但是，在 Sentinel 或 Redis Cluster Failover 的上下文中，`WAIT`提高现实世界的数据安全性。

具体来说，如果将给定的写入数据传输到一个或多个副本，则更有可能（但不能保证）如果主节点发生故障，我们将能够在故障转移期间升级接收写入的副本：Sentinel 和 Redis Cluster 都将尽最大努力尝试在可用副本集中提升最佳副本。

但是，这只是一次尽力而为的尝试，因此仍有可能丢失同步复制到多个副本的写入操作。

## 实现细节

自从引入了与副本的部分重新同步（PSYNC 功能）以来，Redis 副本会使用已在复制流中处理的偏移量异步 ping 通其主节点。这以多种方式使用：

1.  检测超时的副本。
2.  断开连接后执行部分重新同步。
3.  实现`WAIT`.

在具体实施的情况下`WAIT`，Redis 会记住，对于每个客户端，当给定的复制流时，生成的复制流的复制偏移量
write 命令是在给定客户端的上下文中执行的。什么时候`WAIT`是
称为 Redis 检查是否已确认指定数量的副本
此偏移量或更大的偏移量。

@return

@integer回复：该命令返回在当前连接上下文中执行的所有写入所达到的副本数。

@examples

    > SET foo bar
    OK
    > WAIT 1 0
    (integer) 1
    > WAIT 2 1000
    (integer) 1

在下面的示例中，第一次调用`WAIT`不使用超时，并要求写入达到 1 个副本。它以成功的方式回归。在第二次尝试中，我们放置了一个超时，并要求将写入复制到两个副本。由于有一个副本可用，一秒钟后`WAIT`取消阻止并返回 1，即达到的副本数。
